<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="400" y="40" font-family="Arial" font-size="24" font-weight="bold" text-anchor="middle">Staples Brain - Data Flow Architecture</text>
  
  <!-- User Input Section -->
  <rect x="50" y="80" width="700" height="80" rx="10" ry="10" fill="#e9ecef" stroke="#495057" stroke-width="2"/>
  <text x="400" y="120" font-family="Arial" font-size="18" font-weight="bold" text-anchor="middle">User Input Flow</text>
  
  <!-- User Input Icons -->
  <rect x="100" y="100" width="120" height="40" rx="5" ry="5" fill="#d0ebff" stroke="#1864ab" stroke-width="2"/>
  <text x="160" y="125" font-family="Arial" font-size="14" text-anchor="middle">User Request</text>
  
  <polygon points="250,120 270,100 290,120 270,140" fill="#d0ebff" stroke="#1864ab" stroke-width="2"/>
  <text x="270" y="125" font-family="Arial" font-size="14" text-anchor="middle">Intent</text>
  
  <rect x="320" y="100" width="120" height="40" rx="5" ry="5" fill="#d0ebff" stroke="#1864ab" stroke-width="2"/>
  <text x="380" y="125" font-family="Arial" font-size="14" text-anchor="middle">Agent Selection</text>
  
  <rect x="470" y="100" width="120" height="40" rx="5" ry="5" fill="#d0ebff" stroke="#1864ab" stroke-width="2"/>
  <text x="530" y="125" font-family="Arial" font-size="14" text-anchor="middle">Agent Processing</text>
  
  <rect x="620" y="100" width="120" height="40" rx="5" ry="5" fill="#d0ebff" stroke="#1864ab" stroke-width="2"/>
  <text x="680" y="125" font-family="Arial" font-size="14" text-anchor="middle">Response</text>
  
  <!-- Data Flow Arrows -->
  <line x1="220" y1="120" x2="240" y2="120" stroke="#1864ab" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="300" y1="120" x2="320" y2="120" stroke="#1864ab" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="440" y1="120" x2="470" y2="120" stroke="#1864ab" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="590" y1="120" x2="620" y2="120" stroke="#1864ab" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Database Interactions -->
  <rect x="50" y="180" width="700" height="170" rx="10" ry="10" fill="#e9ecef" stroke="#495057" stroke-width="2"/>
  <text x="400" y="210" font-family="Arial" font-size="18" font-weight="bold" text-anchor="middle">Database Integration</text>
  
  <!-- Database Tables -->
  <rect x="100" y="240" width="120" height="40" rx="5" ry="5" fill="#ffe3e3" stroke="#c92a2a" stroke-width="2"/>
  <text x="160" y="265" font-family="Arial" font-size="14" text-anchor="middle">Conversations</text>
  
  <rect x="250" y="240" width="120" height="40" rx="5" ry="5" fill="#ffe3e3" stroke="#c92a2a" stroke-width="2"/>
  <text x="310" y="265" font-family="Arial" font-size="14" text-anchor="middle">Messages</text>
  
  <rect x="400" y="240" width="120" height="40" rx="5" ry="5" fill="#ffe3e3" stroke="#c92a2a" stroke-width="2"/>
  <text x="460" y="265" font-family="Arial" font-size="14" text-anchor="middle">Agent Data</text>
  
  <rect x="550" y="240" width="120" height="40" rx="5" ry="5" fill="#ffe3e3" stroke="#c92a2a" stroke-width="2"/>
  <text x="610" y="265" font-family="Arial" font-size="14" text-anchor="middle">Custom Agents</text>
  
  <!-- Database Access Layer -->
  <rect x="100" y="300" width="570" height="30" rx="5" ry="5" fill="#ffe3e3" stroke="#c92a2a" stroke-width="2"/>
  <text x="385" y="320" font-family="Arial" font-size="14" text-anchor="middle">SQLAlchemy ORM Layer</text>
  
  <!-- Database Flow -->
  <line x1="160" y1="240" x2="160" y2="160" stroke="#c92a2a" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <line x1="310" y1="240" x2="310" y2="160" stroke="#c92a2a" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <line x1="460" y1="240" x2="460" y2="160" stroke="#c92a2a" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <line x1="610" y1="240" x2="610" y2="160" stroke="#c92a2a" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  
  <!-- Observability Layer -->
  <rect x="50" y="370" width="700" height="170" rx="10" ry="10" fill="#e9ecef" stroke="#495057" stroke-width="2"/>
  <text x="400" y="400" font-family="Arial" font-size="18" font-weight="bold" text-anchor="middle">Observability & Telemetry</text>
  
  <!-- Observability Components -->
  <rect x="100" y="430" width="120" height="40" rx="5" ry="5" fill="#d3f9d8" stroke="#2b8a3e" stroke-width="2"/>
  <text x="160" y="455" font-family="Arial" font-size="14" text-anchor="middle">Logging</text>
  
  <rect x="250" y="430" width="120" height="40" rx="5" ry="5" fill="#d3f9d8" stroke="#2b8a3e" stroke-width="2"/>
  <text x="310" y="455" font-family="Arial" font-size="14" text-anchor="middle">Metrics</text>
  
  <rect x="400" y="430" width="120" height="40" rx="5" ry="5" fill="#d3f9d8" stroke="#2b8a3e" stroke-width="2"/>
  <text x="460" y="455" font-family="Arial" font-size="14" text-anchor="middle">LangSmith</text>
  
  <rect x="550" y="430" width="120" height="40" rx="5" ry="5" fill="#d3f9d8" stroke="#2b8a3e" stroke-width="2"/>
  <text x="610" y="455" font-family="Arial" font-size="14" text-anchor="middle">Prometheus</text>
  
  <!-- Observability Collection -->
  <rect x="100" y="490" width="570" height="30" rx="5" ry="5" fill="#d3f9d8" stroke="#2b8a3e" stroke-width="2"/>
  <text x="385" y="510" font-family="Arial" font-size="14" text-anchor="middle">Unified Telemetry Collection</text>
  
  <!-- Observability Flow -->
  <line x1="160" y1="430" x2="160" y2="350" stroke="#2b8a3e" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <line x1="310" y1="430" x2="310" y2="350" stroke="#2b8a3e" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <line x1="460" y1="430" x2="460" y2="350" stroke="#2b8a3e" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <line x1="610" y1="430" x2="610" y2="350" stroke="#2b8a3e" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  
  <!-- Vertical Integration Lines -->
  <line x1="385" y1="160" x2="385" y2="180" stroke="#495057" stroke-width="3" stroke-dasharray="10,5"/>
  <line x1="385" y1="350" x2="385" y2="370" stroke="#495057" stroke-width="3" stroke-dasharray="10,5"/>
  
  <!-- Legend -->
  <rect x="620" y="500" width="20" height="20" fill="#d0ebff" stroke="#1864ab" stroke-width="2"/>
  <text x="685" y="515" font-family="Arial" font-size="12" text-anchor="middle">Processing Flow</text>
  
  <rect x="620" y="530" width="20" height="20" fill="#ffe3e3" stroke="#c92a2a" stroke-width="2"/>
  <text x="685" y="545" font-family="Arial" font-size="12" text-anchor="middle">Database Elements</text>
  
  <rect x="620" y="560" width="20" height="20" fill="#d3f9d8" stroke="#2b8a3e" stroke-width="2"/>
  <text x="685" y="575" font-family="Arial" font-size="12" text-anchor="middle">Observability</text>
  
  <!-- Define the arrowhead marker -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#212529"/>
    </marker>
  </defs>
</svg>
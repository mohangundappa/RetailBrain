<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="600" fill="#222222" rx="10" ry="10"/>
  
  <!-- Title -->
  <text x="400" y="40" font-family="Arial" font-size="24" fill="#ffffff" text-anchor="middle" font-weight="bold">Agent Builder Data Flow</text>
  
  <!-- User Interaction Layer -->
  <rect x="50" y="70" width="700" height="80" fill="#2d2d2d" rx="5" ry="5" stroke="#6c757d" stroke-width="2"/>
  <text x="400" y="100" font-family="Arial" font-size="18" fill="#ffffff" text-anchor="middle" font-weight="bold">User Interface</text>
  
  <!-- Wizard UI -->
  <rect x="70" y="120" width="320" height="30" fill="#007bff" rx="5" ry="5"/>
  <text x="230" y="142" font-family="Arial" font-size="16" fill="#ffffff" text-anchor="middle">Step-by-Step Wizard</text>
  
  <!-- Builder UI -->
  <rect x="410" y="120" width="320" height="30" fill="#20c997" rx="5" ry="5"/>
  <text x="570" y="142" font-family="Arial" font-size="16" fill="#ffffff" text-anchor="middle">Drag-and-Drop Canvas</text>
  
  <!-- API Layer -->
  <rect x="50" y="170" width="700" height="100" fill="#2d2d2d" rx="5" ry="5" stroke="#6c757d" stroke-width="2"/>
  <text x="400" y="195" font-family="Arial" font-size="18" fill="#ffffff" text-anchor="middle" font-weight="bold">API Endpoints</text>
  
  <!-- Wizard Endpoints -->
  <rect x="70" y="220" width="320" height="30" fill="#343a40" rx="5" ry="5" stroke="#007bff" stroke-width="1"/>
  <text x="230" y="242" font-family="Arial" font-size="14" fill="#ffffff" text-anchor="middle">/agent-wizard/step/:step endpoints</text>
  
  <!-- Builder Endpoints -->
  <rect x="410" y="220" width="320" height="30" fill="#343a40" rx="5" ry="5" stroke="#20c997" stroke-width="1"/>
  <text x="570" y="242" font-family="Arial" font-size="14" fill="#ffffff" text-anchor="middle">/api/builder/agents endpoints</text>
  
  <!-- Service Layer -->
  <rect x="50" y="290" width="700" height="110" fill="#2d2d2d" rx="5" ry="5" stroke="#6c757d" stroke-width="2"/>
  <text x="400" y="315" font-family="Arial" font-size="18" fill="#ffffff" text-anchor="middle" font-weight="bold">Service Layer</text>
  
  <!-- Compatibility Module -->
  <rect x="330" y="340" width="140" height="40" fill="#fd7e14" rx="5" ry="5"/>
  <text x="400" y="365" font-family="Arial" font-size="12" fill="#ffffff" text-anchor="middle">Compatibility Layer</text>
  
  <!-- Wizard Service -->
  <rect x="70" y="340" width="120" height="40" fill="#343a40" rx="5" ry="5" stroke="#007bff" stroke-width="1"/>
  <text x="130" y="365" font-family="Arial" font-size="12" fill="#ffffff" text-anchor="middle">Wizard Service</text>
  
  <!-- Builder Service -->
  <rect x="610" y="340" width="120" height="40" fill="#343a40" rx="5" ry="5" stroke="#20c997" stroke-width="1"/>
  <text x="670" y="365" font-family="Arial" font-size="12" fill="#ffffff" text-anchor="middle">Builder Service</text>
  
  <!-- Database Layer -->
  <rect x="50" y="420" width="700" height="140" fill="#2d2d2d" rx="5" ry="5" stroke="#6c757d" stroke-width="2"/>
  <text x="400" y="445" font-family="Arial" font-size="18" fill="#ffffff" text-anchor="middle" font-weight="bold">Database Layer</text>
  
  <!-- CustomAgent Table -->
  <rect x="350" y="470" width="100" height="60" fill="#343a40" rx="5" ry="5" stroke="#6c757d" stroke-width="1"/>
  <text x="400" y="495" font-family="Arial" font-size="12" fill="#ffffff" text-anchor="middle">CustomAgent</text>
  <text x="400" y="515" font-family="Arial" font-size="10" fill="#ffffff" text-anchor="middle">configuration JSON</text>
  
  <!-- Component Table -->
  <rect x="200" y="470" width="100" height="60" fill="#343a40" rx="5" ry="5" stroke="#6c757d" stroke-width="1"/>
  <text x="250" y="495" font-family="Arial" font-size="12" fill="#ffffff" text-anchor="middle">AgentComponent</text>
  <text x="250" y="515" font-family="Arial" font-size="10" fill="#ffffff" text-anchor="middle">visual components</text>
  
  <!-- Connection Table -->
  <rect x="500" y="470" width="100" height="60" fill="#343a40" rx="5" ry="5" stroke="#6c757d" stroke-width="1"/>
  <text x="550" y="495" font-family="Arial" font-size="12" fill="#ffffff" text-anchor="middle">Component</text>
  <text x="550" y="515" font-family="Arial" font-size="12" fill="#ffffff" text-anchor="middle">Connection</text>
  
  <!-- Fix highlight -->
  <rect x="330" y="380" width="140" height="20" fill="#dc3545" rx="5" ry="5" opacity="0.7"/>
  <text x="400" y="395" font-family="Arial" font-size="12" fill="#ffffff" text-anchor="middle" font-weight="bold">Issue Fixed Here âœ“</text>
  
  <!-- Arrows and connections -->
  <!-- Wizard UI to API -->
  <path d="M230,150 L230,220" stroke="#007bff" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Builder UI to API -->
  <path d="M570,150 L570,220" stroke="#20c997" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Wizard API to Wizard Service -->
  <path d="M230,250 L130,340" stroke="#007bff" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Builder API to Builder Service -->
  <path d="M570,250 L670,340" stroke="#20c997" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Wizard Service to Compatibility -->
  <path d="M190,360 L330,360" stroke="#007bff" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Builder Service to Compatibility -->
  <path d="M610,360 L470,360" stroke="#20c997" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Compatibility to Database -->
  <path d="M400,380 L400,470" stroke="#fd7e14" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Database relationships -->
  <path d="M350,500 L300,500" stroke="#6c757d" stroke-width="1" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="5,2"/>
  <path d="M450,500 L500,500" stroke="#6c757d" stroke-width="1" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="5,2"/>
  
  <!-- Arrow marker -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ffffff"/>
    </marker>
  </defs>
  
  <!-- Key boxes -->
  <rect x="650" y="20" width="120" height="20" fill="#007bff" rx="5" ry="5"/>
  <text x="710" y="35" font-family="Arial" font-size="12" fill="#ffffff" text-anchor="middle">Wizard Flow</text>
  
  <rect x="650" y="45" width="120" height="20" fill="#20c997" rx="5" ry="5"/>
  <text x="710" y="60" font-family="Arial" font-size="12" fill="#ffffff" text-anchor="middle">Builder Flow</text>
  
  <rect x="650" y="70" width="120" height="20" fill="#fd7e14" rx="5" ry="5"/>
  <text x="710" y="85" font-family="Arial" font-size="12" fill="#ffffff" text-anchor="middle">Compatibility</text>
</svg>
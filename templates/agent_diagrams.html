<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Builder System Design Diagrams</title>
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/agent_architecture.css">
    <style>
        body {
            padding: 20px;
            background-color: #222;
            color: #fff;
        }
        .diagram-container {
            margin-bottom: 40px;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 20px;
            background-color: #333;
        }
        h1, h2 {
            color: #fff;
        }
        .diagram-container img {
            max-width: 100%;
            height: auto;
            margin-top: 20px;
        }
        .description {
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center mb-5">Agent Builder System Design Diagrams</h1>
        
        <div class="diagram-container">
            <h2>1. Agent Builder Architecture</h2>
            <p class="description">This diagram shows the overall architecture of the Agent Builder system, with both the wizard and drag-and-drop approaches.</p>
            <div class="text-center">
                <embed src="/static/diagrams/agent_builder_architecture.svg" type="image/svg+xml" width="800" height="600" />
            </div>
        </div>
        
        <div class="diagram-container">
            <h2>2. Agent Data Flow</h2>
            <p class="description">This diagram illustrates how data flows through the system from the user interface through to the database layer.</p>
            <div class="text-center">
                <embed src="/static/diagrams/agent_data_flow.svg" type="image/svg+xml" width="800" height="600" />
            </div>
        </div>
        
        <div class="diagram-container">
            <h2>3. Agent Component Structure</h2>
            <p class="description">This diagram shows the internal component structure within an agent, including component connections and tools. It illustrates how the core logic connects to various subsystems like memory, entity framework, and tools.</p>
            <div class="text-center">
                <embed src="/static/diagrams/agent_component_structure_with_tools.svg" type="image/svg+xml" width="800" height="600" />
            </div>
        </div>
        
        <div class="diagram-container">
            <h2>4. Agent Component Architecture - Enhanced</h2>
            <p class="description">This enhanced architectural diagram incorporates expert feedback to show a comprehensive view of the agent structure, including LangChain integration, security & guardrails, tool orchestration, and performance features.</p>
            <div class="text-center">
                <div id="architecture-container">
                    <!-- HTML content will be loaded here via JavaScript -->
                </div>
            </div>
        </div>
        
        <div class="diagram-container">
            <h2>5. Agent Internal Architecture</h2>
            <p class="description">This detailed diagram illustrates the internal architecture of an agent, showing both the core components shared across all agents and the specialized components unique to each agent type.</p>
            <div class="text-center">
                <embed src="/static/diagrams/agent_internal_structure.svg" type="image/svg+xml" width="800" height="600" />
            </div>
        </div>
        
        <div class="diagram-container">
            <h2>6. End-to-End Flow: From User Input to Response</h2>
            <p class="description">This comprehensive diagram shows the complete end-to-end flow from user input to response generation, with numbered steps (1-22) indicating the sequence of operations.</p>
            <div class="text-center">
                <embed src="/static/diagrams/end_to_end_flow.svg" type="image/svg+xml" width="900" height="700" />
            </div>
        </div>

        <div class="diagram-container">
            <h2>7. Enhanced End-to-End Architecture</h2>
            <p class="description">This enhanced architectural diagram implements expert feedback with visual improvements for better understandability. Key enhancements include: layered visual grouping, fallback paths for error handling, asynchronous processing indicators, horizontal scaling markers, data persistence indicators, and a dedicated analytics feedback loop. Components are organized by layer (Interface, Orchestration, Processing, and Data) for clearer visualization.</p>
            <div id="enhanced-flow-container" class="text-center">
                <!-- Content will be loaded via JavaScript -->
            </div>
        </div>
    </div>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Fetch the architecture HTML content
        fetch('/static/html/agent_architecture.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('architecture-container').innerHTML = html;
            })
            .catch(error => {
                console.error('Error loading architecture diagram:', error);
                document.getElementById('architecture-container').innerHTML = 
                    '<p class="text-danger">Error loading architecture diagram. Please refresh the page.</p>';
            });
            
        // Fetch the enhanced end-to-end flow HTML content
        fetch('/static/html/enhanced_end_to_end_flow.html')
            .then(response => response.text())
            .then(html => {
                // Create a container for the HTML content
                const container = document.createElement('div');
                container.innerHTML = html;
                
                // Extract only the body content, excluding head elements
                const bodyContent = container.querySelector('body').innerHTML;
                
                // Insert the body content into the container
                document.getElementById('enhanced-flow-container').innerHTML = bodyContent;
            })
            .catch(error => {
                console.error('Error loading enhanced flow diagram:', error);
                document.getElementById('enhanced-flow-container').innerHTML = 
                    '<p class="text-danger">Error loading enhanced flow diagram. Please refresh the page.</p>';
            });
    });
    </script>
</body>
</html>